{% include 'header.html' %} 
{% load static %}

{% block content %}
{% if message %}
    <div id="alert" class="alert alert-success">{{ message }}</div>
    <script>
        setTimeout(function() {
            document.getElementById("alert").style.display = "none";
        }, 5000);
    </script>
{% endif %}
  <div class="container">

    <h3 class="title">
      <center style="text-decoration: underline; color: #561c32 ;font-family: 'Courier New', Courier, monospace;">Dashboard</center>
    </h3>

    {% if userprofile.is_employer %}
    {% if messages %}
        <ul class="alert alert-danger">
            {% for message1 in messages %}
                <li>{{ message1 }}</li>
                <script>
                  setTimeout(function () {
                    document.getElementById("alert").style.display = "none";
                  }, 5000);
                </script>
            {% endfor %}
        </ul>
    {% endif %}
<h4 class="subtitle">Welcome  {{userprofile.user}}
  (Employer)
  
</h4>
<div style="display: flex;">

  <div><a href="{% url 'job:add'  %}">
    <input
    type="submit"
    value="Add Job"
    class="m-1 px-5 btn btn-primary"
    style="background-color: #561c32"
    /> 
  </div>
  <div><a href="{% url 'job:job_pdf'  %}">
    <input
    type="submit"
    value="Job PDF"
    class="m-1 px-5 btn btn-primary"
    style="background-color: #561c32"
    /> <a href=""></a>
  </div>
</div>
<h3 class="subtitle">View all jobs posted</h3>


<table class="table table table-striped table-bordered">
  <thead class="thead-dark">
    <tr>
      <th scope="col">Job Id</th>
      <th scope="col">Job name</th>
      <th scope="col">Date created</th>
      <th scope="col">View Aplicants</th>
      <th scope="col">Edit Job</th>

    </tr>
  </thead>
  <tbody>
    {% for job in request.user.jobs.all %}
    <tr>
      <th scope="row">   {{ job.id }} </a></th>
      <td>  {{ job.title }} ({{job.get_status_display}})</td>
      <td>  {{ job.created_at }}</td>
      <td><a href="{% url 'view_dashboard_job' job.id%}"><i class="fas fa-bars"></i> Candidates</td>
        <td>
          <a href="{% url 'job:edit' job.id %}">
  
            <img src="{% static 'edit.png' %}" width= "20" height="20"alt="My Image">
          </a>
    </tr>
    
    {% empty %}
    <p>You have not posted any jobs yet...</p>
    {% endfor %} 
  </tbody>
</table>
{% else %}
{% if messages %}
<ul class="alert alert-danger">
    {% for message1 in messages %}
        <li>{{ message1 }}</li>
        <script>
          setTimeout(function () {
            document.getElementById("alert").style.display = "none";
          }, 5000);
        </script>
    {% endfor %}
</ul>
{% endif %}
<h4 class="subtitle">Welcome {{userprofile.user}}(Jobseeker) </h4>
<h5 class="subtitle" style="font-family: 'Courier New', Courier, monospace;">All Applications Aplied</h5>
<!-- <style>
  table,
  th,
  td {
    border: 3px solid black;
  }
</style> -->

<table class="table table-striped table-bordered" style="width: 100%">
  <thead class="thead-dark">

    <tr>
      <th scope="col">Job Title</th>
      <th scope="col">First Name</th>
      <th scope="col">Last Name</th>
      <th scope="col">Email</th>
      <th scope="col">Location</th>
      <th scope="col">View Application</th>
      <th scope="col">Delete Application</th>
      <th scope="col">Edit </th>
      <th scope="col">Status </th>


    </tr>
  </thead>
  
  {% for application in request.user.applications.all %}
  <tbody>

    <tr>
      <td>{{ application.job.title }}</td>
      <td>{{ application.first_name }}</td>
      <td>{{ application.last_name }}</td>
      <td>{{ application.email }}</td>
      <td>{{ application.location }}</td>
      <td>
        <a
        href="{% url 'view_application' application.id %}
        "
        >
        <input
        type="submit"
        value="view"
        class="m-1 px-5 btn btn-primary"
          style="background-color: #561c32"
          />
        </a>
      </td>
      <td>
        <form action="{% url 'job:delete_application' application.id %}" method="post">
          {% csrf_token %}
          <input type="submit" value="Delete"   class="m-1 px-5 btn btn-primary"
          style="background-color: #fa0303" onclick="return confirmDelete();">
        </form>
        <!-- <a href="{% url 'job:delete_application' application.id %}">
          <input
          type="submit"
          value="delete"
          class="m-1 px-5 btn btn-primary"
          style="background-color: #fa0303"
          />
        </a> -->
      </td>
      <td>
        <a href="{% url 'job:edit_app' application.id %}">

          <img src="{% static 'edit.png' %}" width= "20" height="20" alt="My Image">
        </a>
      </td>
      <td>     
    {%if application.status == 'pending'%}
    <h6> <span style="color: white; border-radius: 5px; padding: 5px; background-color: black">{{application.status}}</span> </h6>
    {%elif application.status == 'approved'%}
    <h6> <span style="color: green; border-radius: 5px; padding: 5px; background-color: black">{{application.status}}</span> </h6>
    {%elif application.status == 'declined'%}
    <h6> <span style="color: red; border-radius: 5px; padding: 5px; background-color: black">{{application.status}}</span> </h6>
    {%endif%} 
  </td>

    </tr>
  </tbody>
    {% empty %}
  <p>You have not applied for any jobs yet..</p>
  {% endfor %}
</table>
{% endif %}




</div>
<script>
  function confirmDelete() {
    return confirm("Are you sure you want to delete?");
  }
</script>
{% endblock %}

